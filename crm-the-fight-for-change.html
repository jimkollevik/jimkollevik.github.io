<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Works & Notes by Jim Kollevik | CRM - The fight for change</title>
	<link rel="stylesheet" type="text/css" href="default.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">

	<!-- inline css for pages -->
	<style type="text/css">
		.content {
			width: 500px;
		}
		.content p:first-child, .content p:nth-child(2), .content p:nth-child(4) {
			margin: 0 0 40px 0;
		}
		.content p:nth-child(2), .content p:nth-child(4) {
			line-height: 20px;
		}
		.content p:nth-child(6) {
			margin: 0 0 80px 0;
			line-height: 20px;
		}
		h1 {
			margin: 0 0 10px 0;
		}
		/* mobile device styling */
		@media screen and (max-width: 480px) {
			.content {
				width: 90%;
			}
			.content p:nth-child(6) {
				margin: 0 0 40px 0;
			}
		@media (prefers-color-scheme: dark) {
			.dark {
				color: #D9AF62;
			}
		}
	</style>

</head>
<body>

<section class="wrapper">
	<header>
    <div id="tracks" class="light-grey default-font">
		  <p class="track"></p>
    </div><!-- end tracks -->
		<p class="dark-grey">(creative) works & notes of <span class="dark"><a href="index.html">Jim Kollevik.</a></span></p>
	</header>
	<section class="content">
		<p class="dark"><span class="light-grey">CRM —</span> The fight for change</p>
		<p class="default-font dark-grey">Donec nisl mauris, condimentum nec nibh at, laoreet semper nulla. Cras dignissim suscipit elit vel elementum. Sed mattis erat non ipsum dapibus condimentum. Pellentesque id felis ac felis aliquam interdum. Vestibulum pharetra maximus justo vitae sollicitudin. Aliquam eget lectus nunc. Fusce molestie libero vel eros pulvinar rutrum.</p>

		<h1 class="default-font">Heading 1</h1>
		<p class="default-font dark-grey">Vestibulum vitae sollicitudin arcu. Praesent non ipsum eu nunc malesuada facilisis sit amet vel erat. Curabitur congue eleifend neque vitae vestibulum. Nullam eleifend facilisis egestas. Quisque eu nunc in lectus dignissim pulvinar vitae sit amet purus. Sed iaculis ante nunc, ultrices consectetur enim pulvinar laoreet. Donec ac nibh nibh. Nullam ultrices ullamcorper pharetra.</p>

		<h1 class="default-font">Heading 2</h1>
		<p class="default-font dark-grey">Mauris at velit in risus vehicula eleifend ac nec massa. Nulla est turpis, porttitor et est sed, pulvinar condimentum est. Curabitur et ex nec eros vehicula euismod.
		Nulla est turpis, porttitor et est sed, pulvinar condimentum est. Curabitur et ex nec eros vehicula euismod.</p>		
		<p><a href=""><span class="light-grey">MA —</span> The story of journeys & sql &rarr;</a></p>
	</section>
	<footer>
		<p class="dark-grey"><a class="dark-grey" href="@mailto:jim.kollevik@gmail.com">jim.kollevik@gmail.com</a> - <a class="dark-grey" href="">curriculum vitae</a></p>
		<p class="light-grey">Made for the love of minimalism</p>
	</footer>
</section><!-- end wrapper -->

<script>
    // URL till JSON-filen hostad på GitHub Pages
    const apiUrl = "https://jimkollevik.github.io/recent-tracks.json";

    async function fetchRecentTracks() {
      const tracksDiv = document.getElementById("tracks");
      try {
        const response = await fetch(apiUrl);
        if (!response.ok) {
          throw new Error(`HTTP-fel! Status: ${response.status}`);
        }
        const data = await response.json();

        // Töm innehåll och visa ENDAST den senaste låten
        tracksDiv.innerHTML = "";

        // Hämta endast den första låten (index 0)
        const track = data.recenttracks.track[0];
        if (track) {
          const trackName = track.name;
          const artistName = track.artist["#text"];
          const trackUrl = track.url; // URL till låten på LastFM

          // Skapa HTML med en länk
          const trackDiv = document.createElement("div");
          trackDiv.className = "track";
          trackDiv.innerHTML = `
            Last played track: 
            <a href="${trackUrl}" target="_blank" rel="noopener noreferrer">
              ${trackName} - ${artistName} &#8599;
            </a>
          `;
          tracksDiv.appendChild(trackDiv);
        } else {
          tracksDiv.innerHTML = "Inga låtar hittades.";
        }
      } catch (error) {
        console.error("Fel vid hämtning av låtar:", error);
        tracksDiv.innerHTML = "Kunde inte hämta låtar.";
      }
    }

    // Kör funktionen när sidan laddas
    fetchRecentTracks();
</script>

</body>
</html>